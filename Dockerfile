FROM ubuntu:bionic
RUN apt-get update --assume-yes &&\
  apt-get upgrade --assume-yes
RUN apt-get install git cmake zlib1g-dev libssl-dev build-essential libgcrypt20-dev --assume-yes
RUN git clone git://git.libssh.org/projects/libssh.git /root/libssh
RUN cd /root/libssh && git checkout libssh-0.8.3 && mkdir /root/libssh/build && cd /root/libssh/build && cmake .. && make
RUN ssh-keygen -t dsa -f /root/ssh_host_dsa_key -N ''
RUN ssh-keygen -t rsa -b 2048 -f /root/ssh_host_rsa_key -N ''
EXPOSE 22
CMD ["/root/libssh/build/examples/ssh_server_fork", "-p", "22","-d", "/root/ssh_host_dsa_key", "-k", "/root/ssh_host_rsa_key","-v","0.0.0.0"]
